<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Tips and Tricks | User Guide: The ALSroads Package</title>
  <meta name="description" content="A user guide for road extraction using the ALSroads package" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Tips and Tricks | User Guide: The ALSroads Package" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A user guide for road extraction using the ALSroads package" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Tips and Tricks | User Guide: The ALSroads Package" />
  
  <meta name="twitter:description" content="A user guide for road extraction using the ALSroads package" />
  

<meta name="author" content="Ilythia D. Morley, Jean-Romain Roussel" />


<meta name="date" content="2022-11-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sec-waterbodies.html"/>
<link rel="next" href="sec-getting-started-with-r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<script src="libs/FlatGeoBuf-3.21.3/fgb.js"></script>
<script src="libs/FlatGeoBuf-3.21.3/flatgeobuf-geojson.min.js"></script>
<script src="libs/chromajs-2.1.0/chroma.min.js"></script>
<link id="ctg-1-attachment" rel="attachment" href="libs/ctg-0.0.1/ctg_layer.fgb"/>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<link id="Water-1-attachment" rel="attachment" href="libs/Water-0.0.1/Water_layer.fgb"/>
<link id="RoadSegments-1-attachment" rel="attachment" href="libs/RoadSegments-0.0.1/RoadSegments_layer.fgb"/>
<link id="Inaccurate-1-attachment" rel="attachment" href="libs/Inaccurate-0.0.1/Inaccurate_layer.fgb"/>
<link id="Corrected-1-attachment" rel="attachment" href="libs/Corrected-0.0.1/Corrected_layer.fgb"/>
<link id="CorrectedRoad-1-attachment" rel="attachment" href="libs/CorrectedRoad-0.0.1/CorrectedRoad_layer.fgb"/>
<link id="RoadWidthBuffer-1-attachment" rel="attachment" href="libs/RoadWidthBuffer-0.0.1/RoadWidthBuffer_layer.fgb"/>
<link id="Existing-1-attachment" rel="attachment" href="libs/Existing-0.0.1/Existing_layer.fgb"/>
<link id="Updated-1-attachment" rel="attachment" href="libs/Updated-0.0.1/Updated_layer.fgb"/>
<link id="Snapped-1-attachment" rel="attachment" href="libs/Snapped-0.0.1/Snapped_layer.fgb"/>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="sec-road-extraction-data-requirements.html"><a href="sec-road-extraction-data-requirements.html"><i class="fa fa-check"></i><b>2</b> Road Extraction Data Requirements</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sec-road-extraction-data-requirements.html"><a href="sec-road-extraction-data-requirements.html#sec-lidar-data"><i class="fa fa-check"></i><b>2.1</b> LiDAR Data</a></li>
<li class="chapter" data-level="2.2" data-path="sec-road-extraction-data-requirements.html"><a href="sec-road-extraction-data-requirements.html#sec-dtm-data"><i class="fa fa-check"></i><b>2.2</b> DTM Data</a></li>
<li class="chapter" data-level="2.3" data-path="sec-road-extraction-data-requirements.html"><a href="sec-road-extraction-data-requirements.html#sec-existing-road-network"><i class="fa fa-check"></i><b>2.3</b> Existing Road Network</a></li>
<li class="chapter" data-level="2.4" data-path="sec-road-extraction-data-requirements.html"><a href="sec-road-extraction-data-requirements.html#sec-water-bodies"><i class="fa fa-check"></i><b>2.4</b> Water Bodies (optional)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sec-reading-generating-and-plotting-input-data.html"><a href="sec-reading-generating-and-plotting-input-data.html"><i class="fa fa-check"></i><b>3</b> Reading, Generating, and Plotting Input Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec-reading-generating-and-plotting-input-data.html"><a href="sec-reading-generating-and-plotting-input-data.html#sec-reading-lidar-data"><i class="fa fa-check"></i><b>3.1</b> Reading LiDAR data</a></li>
<li class="chapter" data-level="3.2" data-path="sec-reading-generating-and-plotting-input-data.html"><a href="sec-reading-generating-and-plotting-input-data.html#sec-reading-lidar-data-using-readlascatalog"><i class="fa fa-check"></i><b>3.2</b> Reading LiDAR data using <code>readLAScatalog</code></a></li>
<li class="chapter" data-level="3.3" data-path="sec-reading-generating-and-plotting-input-data.html"><a href="sec-reading-generating-and-plotting-input-data.html#sec-reading-and-generating-dtm-raster-data"><i class="fa fa-check"></i><b>3.3</b> Reading and Generating DTM Raster Data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sec-reading-generating-and-plotting-input-data.html"><a href="sec-reading-generating-and-plotting-input-data.html#sec-reading-raster-dtm-data-using-raster"><i class="fa fa-check"></i><b>3.3.1</b> Reading a raster DTM using <code>raster</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="sec-reading-generating-and-plotting-input-data.html"><a href="sec-reading-generating-and-plotting-input-data.html#sec-generating-dtm-data-using-grid_terrain"><i class="fa fa-check"></i><b>3.3.2</b> Generating DTM data using <code>rasterize_terrain()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sec-reading-generating-and-plotting-input-data.html"><a href="sec-reading-generating-and-plotting-input-data.html#sec-reading-vector-road-data-using-st_read"><i class="fa fa-check"></i><b>3.4</b> Reading Vector Road Data using <code>st_read()</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sec-road-extraction-using-alsroads.html"><a href="sec-road-extraction-using-alsroads.html"><i class="fa fa-check"></i><b>4</b> Road Extraction with <code>ALSroads</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="sec-road-extraction-using-alsroads.html"><a href="sec-road-extraction-using-alsroads.html#sec-standard-road-extraction-using-measure_roads"><i class="fa fa-check"></i><b>4.1</b> Standard Road Extraction using <code>measure_roads()</code></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sec-road-extraction-using-alsroads.html"><a href="sec-road-extraction-using-alsroads.html#sec-required-r-packages"><i class="fa fa-check"></i><b>4.1.1</b> Required R Packages:</a></li>
<li class="chapter" data-level="4.1.2" data-path="sec-road-extraction-using-alsroads.html"><a href="sec-road-extraction-using-alsroads.html#sec-input-data"><i class="fa fa-check"></i><b>4.1.2</b> Input Data</a></li>
<li class="chapter" data-level="4.1.3" data-path="sec-road-extraction-using-alsroads.html"><a href="sec-road-extraction-using-alsroads.html#sec-network-update"><i class="fa fa-check"></i><b>4.1.3</b> Network Update</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sec-road-extraction-using-alsroads.html"><a href="sec-road-extraction-using-alsroads.html#sec-applying-measure_roads"><i class="fa fa-check"></i><b>4.2</b> Applying <code>measure_roads()</code></a></li>
<li class="chapter" data-level="4.3" data-path="sec-road-extraction-using-alsroads.html"><a href="sec-road-extraction-using-alsroads.html#sec-spatial-plotting-updated-roads"><i class="fa fa-check"></i><b>4.3</b> Spatial Plotting Updated Roads</a></li>
<li class="chapter" data-level="4.4" data-path="sec-road-extraction-using-alsroads.html"><a href="sec-road-extraction-using-alsroads.html#sec-attribute-plotting-updated-roads"><i class="fa fa-check"></i><b>4.4</b> Attribute Plotting Updated Roads</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sec-standard-parameters.html"><a href="sec-standard-parameters.html"><i class="fa fa-check"></i><b>5</b> Standard Parameters</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sec-standard-parameters.html"><a href="sec-standard-parameters.html#sec-extraction-parameters"><i class="fa fa-check"></i><b>5.1</b> Extraction Parameters:</a></li>
<li class="chapter" data-level="5.2" data-path="sec-standard-parameters.html"><a href="sec-standard-parameters.html#sec-embankment-parameters"><i class="fa fa-check"></i><b>5.2</b> Embankment Parameters:</a></li>
<li class="chapter" data-level="5.3" data-path="sec-standard-parameters.html"><a href="sec-standard-parameters.html#sec-terrain-parameters"><i class="fa fa-check"></i><b>5.3</b> Terrain Parameters (excluding embankment):</a></li>
<li class="chapter" data-level="5.4" data-path="sec-standard-parameters.html"><a href="sec-standard-parameters.html#sec-vegetation-parameters"><i class="fa fa-check"></i><b>5.4</b> Vegetation:</a></li>
<li class="chapter" data-level="5.5" data-path="sec-standard-parameters.html"><a href="sec-standard-parameters.html#sec-conductivity-parameters"><i class="fa fa-check"></i><b>5.5</b> Conductivity Parameters:</a></li>
<li class="chapter" data-level="5.6" data-path="sec-standard-parameters.html"><a href="sec-standard-parameters.html#sec-state-parameters"><i class="fa fa-check"></i><b>5.6</b> Road State Parameters:</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html"><i class="fa fa-check"></i><b>6</b> Case Studies</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#case-study-structure"><i class="fa fa-check"></i><b>6.1</b> Case Study Structure:</a></li>
<li class="chapter" data-level="6.2" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#sec-case-study-low-dtm-complexity"><i class="fa fa-check"></i><b>6.2</b> Case Study 1: Low DTM complexity</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#overview"><i class="fa fa-check"></i><b>6.2.1</b> Overview:</a></li>
<li class="chapter" data-level="6.2.2" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#sec-method-and-application"><i class="fa fa-check"></i><b>6.2.2</b> Data, Method, and Application:</a></li>
<li class="chapter" data-level="6.2.3" data-path="sec-road-extraction-using-alsroads.html"><a href="sec-road-extraction-using-alsroads.html#sec-required-r-packages"><i class="fa fa-check"></i><b>6.2.3</b> Required R Packages:</a></li>
<li class="chapter" data-level="6.2.4" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#sec-results"><i class="fa fa-check"></i><b>6.2.4</b> Results:</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#sec-case-study-no-veg"><i class="fa fa-check"></i><b>6.3</b> Case Study 2: No Vegetation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#overview-1"><i class="fa fa-check"></i><b>6.3.1</b> Overview:</a></li>
<li class="chapter" data-level="6.3.2" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#data-method-and-application"><i class="fa fa-check"></i><b>6.3.2</b> Data, Method, and Application:</a></li>
<li class="chapter" data-level="6.3.3" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#results"><i class="fa fa-check"></i><b>6.3.3</b> Results:</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#sec-case-study-steep-slopes"><i class="fa fa-check"></i><b>6.4</b> Case Study 3: Narrow/Wide Roads</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#overview-2"><i class="fa fa-check"></i><b>6.4.1</b> Overview:</a></li>
<li class="chapter" data-level="6.4.2" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#data-method-and-application-1"><i class="fa fa-check"></i><b>6.4.2</b> Data, Method, and Application:</a></li>
<li class="chapter" data-level="6.4.3" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#results-1"><i class="fa fa-check"></i><b>6.4.3</b> Results:</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#case-study-4-drivable-width-thresholds"><i class="fa fa-check"></i><b>6.5</b> Case Study 4: Drivable Width Thresholds</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#overview-3"><i class="fa fa-check"></i><b>6.5.1</b> Overview:</a></li>
<li class="chapter" data-level="6.5.2" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#data-method-and-application-2"><i class="fa fa-check"></i><b>6.5.2</b> Data, Method, and Application:</a></li>
<li class="chapter" data-level="6.5.3" data-path="sec-edge-case-studies.html"><a href="sec-edge-case-studies.html#results-2"><i class="fa fa-check"></i><b>6.5.3</b> Results:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sec-waterbodies.html"><a href="sec-waterbodies.html"><i class="fa fa-check"></i><b>7</b> Waterbodies</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-waterbodies.html"><a href="sec-waterbodies.html#example-1-road-extraction-without-waterbodies"><i class="fa fa-check"></i><b>7.1</b> Example 1: Road Extraction without Waterbodies</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sec-waterbodies.html"><a href="sec-waterbodies.html#sec-loading-data_wb"><i class="fa fa-check"></i><b>7.1.1</b> Loading Data:</a></li>
<li class="chapter" data-level="7.1.2" data-path="sec-waterbodies.html"><a href="sec-waterbodies.html#updating-roads"><i class="fa fa-check"></i><b>7.1.2</b> Updating Roads</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sec-waterbodies.html"><a href="sec-waterbodies.html#example-2-road-extraction-with-waterbodies"><i class="fa fa-check"></i><b>7.2</b> Example 2: Road Extraction with Waterbodies</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sec-waterbodies.html"><a href="sec-waterbodies.html#sec-loading-data_wb"><i class="fa fa-check"></i><b>7.2.1</b> Loading Data:</a></li>
<li class="chapter" data-level="7.2.2" data-path="sec-waterbodies.html"><a href="sec-waterbodies.html#updating-roads-1"><i class="fa fa-check"></i><b>7.2.2</b> Updating Roads</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sec-waterbodies.html"><a href="sec-waterbodies.html#comparison"><i class="fa fa-check"></i><b>7.3</b> Comparison</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-tips-and-tricks.html"><a href="sec-tips-and-tricks.html"><i class="fa fa-check"></i><b>8</b> Tips and Tricks</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sec-tips-and-tricks.html"><a href="sec-tips-and-tricks.html#sec-casting-roads-to-linestring"><i class="fa fa-check"></i><b>8.1</b> Casting Roads to Linestring</a></li>
<li class="chapter" data-level="8.2" data-path="sec-tips-and-tricks.html"><a href="sec-tips-and-tricks.html#sec-adding-an-id-column"><i class="fa fa-check"></i><b>8.2</b> Adding an ID Column</a></li>
<li class="chapter" data-level="8.3" data-path="sec-tips-and-tricks.html"><a href="sec-tips-and-tricks.html#sec-selecting-specific-roads"><i class="fa fa-check"></i><b>8.3</b> Selecting Specific Roads</a></li>
<li class="chapter" data-level="8.4" data-path="sec-tips-and-tricks.html"><a href="sec-tips-and-tricks.html#sec-plotting-data"><i class="fa fa-check"></i><b>8.4</b> Plotting Data</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="sec-tips-and-tricks.html"><a href="sec-tips-and-tricks.html#sec-interactive-spatial-plotting"><i class="fa fa-check"></i><b>8.4.1</b> Interactive Spatial Plotting with <code>mapView()</code>:</a></li>
<li class="chapter" data-level="8.4.2" data-path="sec-tips-and-tricks.html"><a href="sec-tips-and-tricks.html#sec-spatial-plotting-with-plot"><i class="fa fa-check"></i><b>8.4.2</b> Spatial Plotting with <code>plot()</code>:</a></li>
<li class="chapter" data-level="8.4.3" data-path="sec-tips-and-tricks.html"><a href="sec-tips-and-tricks.html#sec-plotting-with-ggplot"><i class="fa fa-check"></i><b>8.4.3</b> Plotting with <code>ggplot()</code>:</a></li>
<li class="chapter" data-level="8.4.4" data-path="sec-tips-and-tricks.html"><a href="sec-tips-and-tricks.html#sec-plotting-lidar-data"><i class="fa fa-check"></i><b>8.4.4</b> Plotting LiDAR data:</a></li>
<li class="chapter" data-level="8.4.5" data-path="sec-tips-and-tricks.html"><a href="sec-tips-and-tricks.html#sec-3d-plotting-raster-data"><i class="fa fa-check"></i><b>8.4.5</b> 3D Plotting Raster Data:</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="sec-tips-and-tricks.html"><a href="sec-tips-and-tricks.html#sec-saving-data"><i class="fa fa-check"></i><b>8.5</b> Saving Data</a></li>
<li class="chapter" data-level="8.6" data-path="sec-tips-and-tricks.html"><a href="sec-tips-and-tricks.html#sec-reconnecing-roads"><i class="fa fa-check"></i><b>8.6</b> Reconnecting Roads</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sec-getting-started-with-r.html"><a href="sec-getting-started-with-r.html"><i class="fa fa-check"></i><b>9</b> Getting Started with R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-getting-started-with-r.html"><a href="sec-getting-started-with-r.html#sec-installing-r-and-rstudio"><i class="fa fa-check"></i><b>9.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="9.2" data-path="sec-getting-started-with-r.html"><a href="sec-getting-started-with-r.html#sec-installing-alsroad"><i class="fa fa-check"></i><b>9.2</b> Installing <code>ALSroads</code></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-team.html"><a href="sec-team.html"><i class="fa fa-check"></i><b>10</b> Project Team Members</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">User Guide: The <code>ALSroads</code> Package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec-tips-and-tricks" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Tips and Tricks<a href="sec-tips-and-tricks.html#sec-tips-and-tricks" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Following the update of road segments using the <code>ALSroads</code> package, users may wish to edit data, filter results, or plot outcomes. Here, we include code snippets to provide users with basic data manipulation and interpretation tools.</p>
<p>In the following sections, users are recommended to refer to the package manuals for additional information. When using functions in R users can type <code>?function_name()</code> into the R console to find information about the input data requireed, and example applications or that function. For example, running <code>?measure_roads()</code> in the console will bring up information about the function.</p>
<div id="sec-casting-roads-to-linestring" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Casting Roads to Linestring<a href="sec-tips-and-tricks.html#sec-casting-roads-to-linestring" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Existing road networks may be multistring features; the <code>measure_roads()</code> function requires that roads are linestrings. Changing multistring features to linestrings requires the <code>st_cast()</code> function from the <code>sf</code> package (refer to the <a href="https://cran.r-project.org/web/packages/sf/sf.pdf">sf vignette</a> for detailed information).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="sec-tips-and-tricks.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sf&quot;</span>)</span>
<span id="cb46-2"><a href="sec-tips-and-tricks.html#cb46-2" aria-hidden="true" tabindex="-1"></a>roads <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(roads, <span class="st">&quot;LINESTRING&quot;</span>)</span></code></pre></div>
</div>
<div id="sec-adding-an-id-column" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Adding an ID Column<a href="sec-tips-and-tricks.html#sec-adding-an-id-column" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Existing road networks frequently include FID and ID columns that help users select individual roads. In some cases, however, road networks have been edited or updated, and the ID/FID columns are missing information.</p>
<p>Users may wish to add a new ID column that relates explicitly to the roads on which the <code>ALSroads</code> method is applied. In that case, users can add and populate a new column using the <code>rowid_to_column</code> function from the <code>tibble</code> package (refer to the <a href="https://cloud.r-project.org/web/packages/tibble/tibble.pdf">tibble vignette</a> for detailed information).</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="sec-tips-and-tricks.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tribble&quot;</span>)</span>
<span id="cb47-2"><a href="sec-tips-and-tricks.html#cb47-2" aria-hidden="true" tabindex="-1"></a>roads <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">rowid_to_column</span>(roads, <span class="st">&quot;NEW_ID&quot;</span>)</span></code></pre></div>
</div>
<div id="sec-selecting-specific-roads" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Selecting Specific Roads<a href="sec-tips-and-tricks.html#sec-selecting-specific-roads" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Users may wish to update only selected roads from the existing road network, not the entire network. Users can select specific roads using the <code>filter</code> function from the <code>dplyr</code> package (refer to the <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html">dplyr vignette</a> for detailed information).</p>
<p>Users can select roads using an ID column where row values are unique. In this case, we use the “NEW_ID” column (see section <a href="sec-tips-and-tricks.html#sec-adding-an-id-column">8.2</a>).</p>
<p>Users can select a single road:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="sec-tips-and-tricks.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb48-2"><a href="sec-tips-and-tricks.html#cb48-2" aria-hidden="true" tabindex="-1"></a>road_subset <span class="ot">&lt;-</span> roads <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="sec-tips-and-tricks.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(NEW_ID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">10</span>))</span></code></pre></div>
<p>Multiple roads:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="sec-tips-and-tricks.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb49-2"><a href="sec-tips-and-tricks.html#cb49-2" aria-hidden="true" tabindex="-1"></a>road_subset <span class="ot">&lt;-</span> roads <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="sec-tips-and-tricks.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(NEW_ID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>))</span></code></pre></div>
<p>Or, a series of roads (all roads between 10 and 50 will be selected):</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="sec-tips-and-tricks.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb50-2"><a href="sec-tips-and-tricks.html#cb50-2" aria-hidden="true" tabindex="-1"></a>road_subset <span class="ot">&lt;-</span> roads <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="sec-tips-and-tricks.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(NEW_ID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">50</span>))</span></code></pre></div>
</div>
<div id="sec-plotting-data" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Plotting Data<a href="sec-tips-and-tricks.html#sec-plotting-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sec-interactive-spatial-plotting" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Interactive Spatial Plotting with <code>mapView()</code>:<a href="sec-tips-and-tricks.html#sec-interactive-spatial-plotting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Users working within R can produce interactive spatial plots using the function <code>mapView()</code> from the package <code>mapview</code>(refer to the <a href="https://rdrr.io/github/r-spatial/mapview/man/">mapview vignette</a>). The <code>mapView()</code> function produces an interactive view of spatial object(s) on top of a base map.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="sec-tips-and-tricks.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;mapview&quot;</span>)</span>
<span id="cb51-2"><a href="sec-tips-and-tricks.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;leaflet&quot;</span>)</span>
<span id="cb51-3"><a href="sec-tips-and-tricks.html#cb51-3" aria-hidden="true" tabindex="-1"></a>url <span class="ot">=</span> <span class="st">&quot;https://servicesmatriciels.mern.gouv.qc.ca:443/erdas-iws/ogc/wmts/Inventaire_Ecoforestier/Inventaire_Ecoforestier/default/GoogleMapsCompatibleExt2:epsg:3/{z}/{y}/{x}.jpg&quot;</span></span>
<span id="cb51-4"><a href="sec-tips-and-tricks.html#cb51-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mapview<span class="sc">::</span><span class="fu">mapview</span>(<span class="fu">list</span>(existing_road, updated_road),</span>
<span id="cb51-5"><a href="sec-tips-and-tricks.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">layer.name =</span> <span class="fu">c</span>(<span class="st">&quot;Existing&quot;</span>, <span class="st">&quot;Updated&quot;</span>),</span>
<span id="cb51-6"><a href="sec-tips-and-tricks.html#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">map.type =</span> <span class="st">&quot;Esri.WorldImagery&quot;</span>)</span>
<span id="cb51-7"><a href="sec-tips-and-tricks.html#cb51-7" aria-hidden="true" tabindex="-1"></a>leaflet<span class="sc">::</span><span class="fu">addTiles</span>(m<span class="sc">@</span>map, url)</span></code></pre></div>
<div id="htmlwidget-a5b2143cf2986ddf3751" style="width:576px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-a5b2143cf2986ddf3751">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["line",430]},{"method":"addFlatGeoBuf","args":["Existing","Existing",null,true,"1",{"radius":6,"stroke":true,"color":"#FF0000","weight":2,"opacity":0.9,"fill":false,"fillColor":null,"fillOpacity":1},{"className":"","pane":"line"},"mapview-popup",{"radius":{"to":[3,15],"from":[3,15]},"weight":{"to":[1,10],"from":[1,10]},"opacity":{"to":[0,1],"from":[0,1]},"fillOpacity":{"to":[0,1],"from":[0,1]}}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-80.0582466206856,46.5099143292706,-80.0559736415184,46.5131668807429,true,"Existing","Zoom to Existing","<strong> Existing <\/strong>","bottomright"]},{"method":"addLegend","args":[{"colors":["#FF0000"],"labels":["Existing"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"Existing"}]},{"method":"addFlatGeoBuf","args":["Updated","Updated",null,true,"1",{"radius":6,"stroke":true,"color":"#0000FF","weight":2,"opacity":0.9,"fill":false,"fillColor":null,"fillOpacity":1},{"className":"","pane":"line"},"mapview-popup",{"radius":{"to":[3,15],"from":[3,15]},"weight":{"to":[1,10],"from":[1,10]},"opacity":{"to":[0,1],"from":[0,1]},"fillOpacity":{"to":[0,1],"from":[0,1]}}]},{"method":"addHomeButton","args":[-80.0583095984839,46.5099626341744,-80.0559415155369,46.5131684757579,true,"Updated","Zoom to Updated","<strong> Updated <\/strong>","bottomright"]},{"method":"addLayersControl","args":["Esri.WorldImagery",["Existing","Updated"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#0000FF"],"labels":["Updated"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"Updated"}]},{"method":"addHomeButton","args":[-80.0583095984839,46.5099143292706,-80.0559415155369,46.5131684757579,true,null,"Zoom to full extent","<strong>Zoom full<\/strong>","bottomleft"]},{"method":"addTiles","args":["https://servicesmatriciels.mern.gouv.qc.ca:443/erdas-iws/ogc/wmts/Inventaire_Ecoforestier/Inventaire_Ecoforestier/default/GoogleMapsCompatibleExt2:epsg:3/{z}/{y}/{x}.jpg",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false}]}],"fitBounds":[46.5099143292706,-80.0583095984839,46.5131684757579,-80.0559415155369,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
<div id="sec-spatial-plotting-with-plot" class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Spatial Plotting with <code>plot()</code>:<a href="sec-tips-and-tricks.html#sec-spatial-plotting-with-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For generic plotting, users can use the <code>plot()</code> function, which is included in base R.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="sec-tips-and-tricks.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(updated_road[<span class="dv">1</span>]) <span class="co">#[1] specifies that only the first attribute will plot</span></span></code></pre></div>
<p><img src="ALSroads-book_files/figure-html/plot-base-example-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="sec-plotting-with-ggplot" class="section level3 hasAnchor" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> Plotting with <code>ggplot()</code>:<a href="sec-tips-and-tricks.html#sec-plotting-with-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot2</code> is a plotting package that supports the creation of complex plots. <code>ggplot2</code> is commonly used, in R, to produce publication-quality plots. For detailed information on using <code>ggplot2</code>, we recommend users refer to the <a href="https://ggplot2.tidyverse.org/">ggplot2 website</a>. See section <a href="sec-road-extraction-using-alsroads.html#sec-attribute-plotting-updated-roads">4.4</a> for more examples of plotting road attributes using <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="sec-tips-and-tricks.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb53-2"><a href="sec-tips-and-tricks.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>updated_roads, <span class="fu">aes</span>(<span class="at">x=</span>CLASS, <span class="at">y=</span> SCORE, <span class="at">fill=</span>CLASS)) <span class="sc">+</span></span>
<span id="cb53-3"><a href="sec-tips-and-tricks.html#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">size =</span> <span class="fl">0.25</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">coef =</span> <span class="dv">1</span>, <span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb53-4"><a href="sec-tips-and-tricks.html#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Road Score&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Road class&quot;</span>)<span class="sc">+</span></span>
<span id="cb53-5"><a href="sec-tips-and-tricks.html#cb53-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span></code></pre></div>
<p><img src="ALSroads-book_files/figure-html/plot-ggplot-example-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="sec-plotting-lidar-data" class="section level3 hasAnchor" number="8.4.4">
<h3><span class="header-section-number">8.4.4</span> Plotting LiDAR data:<a href="sec-tips-and-tricks.html#sec-plotting-lidar-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>lidR</code> package takes advantage of the <code>rgl</code> package to provide an interactive 3D viewer with points coloured by Z coordinates. The <code>lidR</code> package provides several functions for plotting LiDAR data, that include: overlay plotting and tree-top plotting. We strongly recommend that users interested in plotting LiDAR data refer to the <a href="https://r-lidar.github.io/lidRbook/io.html#plot">lidR book</a>.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="sec-tips-and-tricks.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lidR&quot;</span>)</span>
<span id="cb54-2"><a href="sec-tips-and-tricks.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(las)</span></code></pre></div>
<p><img src="images/las_plot.PNG" /></p>
</div>
<div id="sec-3d-plotting-raster-data" class="section level3 hasAnchor" number="8.4.5">
<h3><span class="header-section-number">8.4.5</span> 3D Plotting Raster Data:<a href="sec-tips-and-tricks.html#sec-3d-plotting-raster-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong><code>rayshader</code></strong> is an open source package for producing 2D and 3D data visualizations in R. <code>rayshader</code> uses elevation data in a base R matrix and a combination of raytracing, hillshading algorithms, and overlays to generate 2D and 3D maps (refer to the <a href="https://www.rayshader.com/">rayshader website</a> for more information).</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="sec-tips-and-tricks.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rayshader)</span>
<span id="cb55-2"><a href="sec-tips-and-tricks.html#cb55-2" aria-hidden="true" tabindex="-1"></a>elmat <span class="ot">&lt;-</span> <span class="fu">raster_to_matrix</span>(dtm)</span>
<span id="cb55-3"><a href="sec-tips-and-tricks.html#cb55-3" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> elmat <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="sec-tips-and-tricks.html#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sphere_shade</span>(<span class="at">texture =</span> <span class="st">&quot;imhof1&quot;</span>, <span class="at">progbar =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="sec-tips-and-tricks.html#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_water</span>(<span class="fu">detect_water</span>(elmat), <span class="at">color =</span> <span class="st">&quot;imhof1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-6"><a href="sec-tips-and-tricks.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_shadow</span>(<span class="fu">ray_shade</span>(elmat, <span class="at">progbar =</span> <span class="cn">FALSE</span>), <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-7"><a href="sec-tips-and-tricks.html#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_shadow</span>(<span class="fu">ambient_shade</span>(elmat, <span class="at">progbar =</span> <span class="cn">FALSE</span>), <span class="dv">0</span>)</span>
<span id="cb55-8"><a href="sec-tips-and-tricks.html#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_3d</span>(map, elmat, <span class="at">zscale =</span> <span class="dv">20</span>, <span class="at">windowsize =</span> <span class="fu">c</span>(<span class="dv">800</span>, <span class="dv">800</span>))</span></code></pre></div>
<p><img src="images/rayshader_plot.png" /></p>
</div>
</div>
<div id="sec-saving-data" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Saving Data<a href="sec-tips-and-tricks.html#sec-saving-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Following the extraction of roads from an ALS point cloud and the update of the existing road network, users will need to save the new network as a file that can be opened in R and other GIS programs, such as ArcGIS.</p>
<p>To save simple features (lines and polygons), users can use the ‘st_write’ function from the ‘sf’ package (refer to the <a href="https://cran.r-project.org/web/packages/sf/vignettes/sf1.html">sf vignette</a> for detailed information).</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="sec-tips-and-tricks.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sf&quot;</span>)</span>
<span id="cb56-2"><a href="sec-tips-and-tricks.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(road_subset, <span class="st">&quot;path/to/folder/roads_subset.shp&quot;</span>)</span></code></pre></div>
<p>If users have produced raster data files while working with <code>ALSroads</code>, for example a DTM. In that case, this data can be saved using the <code>writeRaster</code> function from the <code>raster</code> package (refer to the <a href="https://cran.r-project.org/web/packages/raster/raster.pdf">raster manual</a> for detailed information).</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="sec-tips-and-tricks.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;raster&quot;</span>)</span>
<span id="cb57-2"><a href="sec-tips-and-tricks.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(DTM, <span class="st">&quot;path/to/folder/DTM.tif&quot;</span>, <span class="at">format =</span> <span class="st">&quot;GTiff&quot;</span>)</span></code></pre></div>
</div>
<div id="sec-reconnecing-roads" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Reconnecting Roads<a href="sec-tips-and-tricks.html#sec-reconnecing-roads" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The updated road network will include all of the roads in the existing road network. However, because the method relocates each road, the updated network may appear disconnected, with road ends no longer perfectly aligning. The <code>st_snap_lines()</code> function was added to the <code>ALSroads</code> package to address this and ensure that the updated road network is topologically valid.</p>
<p>This post-processing step involves the “snapping” of road ends together, with or without prior knowledge of road connections. If users provide the existing road network to the <code>st_snap_lines()</code>, the connection of roads will be more accurate. Users can also specify tolerance (distance) between two roads where snapping will occur.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="sec-tips-and-tricks.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ALSroads&quot;</span>)</span>
<span id="cb58-2"><a href="sec-tips-and-tricks.html#cb58-2" aria-hidden="true" tabindex="-1"></a>snapped_roads <span class="ot">&lt;-</span> <span class="fu">st_snap_lines</span>(<span class="at">roads =</span> updated_roads, <span class="at">ref =</span> existing_roads, <span class="at">field =</span> <span class="st">&quot;NEW_ID&quot;</span>, <span class="at">tolerance =</span> <span class="dv">30</span>)</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="sec-tips-and-tricks.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;mapview&quot;</span>)</span>
<span id="cb59-2"><a href="sec-tips-and-tricks.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;leaflet&quot;</span>)</span>
<span id="cb59-3"><a href="sec-tips-and-tricks.html#cb59-3" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://servicesmatriciels.mern.gouv.qc.ca:443/erdas-iws/ogc/wmts/Inventaire_Ecoforestier/Inventaire_Ecoforestier/default/GoogleMapsCompatibleExt2:epsg:3/{z}/{y}/{x}.jpg&quot;</span></span>
<span id="cb59-4"><a href="sec-tips-and-tricks.html#cb59-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> mapview<span class="sc">::</span><span class="fu">mapview</span>(<span class="fu">list</span>(updated_roads_, snapped_roads<span class="sc">$</span>roads),</span>
<span id="cb59-5"><a href="sec-tips-and-tricks.html#cb59-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer.name =</span> <span class="fu">c</span>(<span class="st">&quot;Updated&quot;</span>, <span class="st">&quot;Snapped&quot;</span>),</span>
<span id="cb59-6"><a href="sec-tips-and-tricks.html#cb59-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="at">map.type =</span> <span class="st">&quot;Esri.WorldImagery&quot;</span>)</span>
<span id="cb59-7"><a href="sec-tips-and-tricks.html#cb59-7" aria-hidden="true" tabindex="-1"></a>leaflet<span class="sc">::</span><span class="fu">addTiles</span>(m<span class="sc">@</span>map, url)</span></code></pre></div>
<div id="htmlwidget-35c9377ae08d44bb662f" style="width:576px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-35c9377ae08d44bb662f">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["line",430]},{"method":"addFlatGeoBuf","args":["Updated","Updated",null,true,["1","2","3"],{"radius":6,"stroke":true,"color":"#FF0000","weight":2,"opacity":0.9,"fill":false,"fillColor":null,"fillOpacity":1},{"className":"","pane":"line"},"mapview-popup",{"radius":{"to":[3,15],"from":[3,15]},"weight":{"to":[1,10],"from":[1,10]},"opacity":{"to":[0,1],"from":[0,1]},"fillOpacity":{"to":[0,1],"from":[0,1]}}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-80.0825547138503,46.5191712159471,-80.0635306573947,46.5213988429813,true,"Updated","Zoom to Updated","<strong> Updated <\/strong>","bottomright"]},{"method":"addLegend","args":[{"colors":["#FF0000"],"labels":["Updated"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"Updated"}]},{"method":"addFlatGeoBuf","args":["Snapped","Snapped",null,true,["1","2","3"],{"radius":6,"stroke":true,"color":"#00FF00","weight":2,"opacity":0.9,"fill":false,"fillColor":null,"fillOpacity":1},{"className":"","pane":"line"},"mapview-popup",{"radius":{"to":[3,15],"from":[3,15]},"weight":{"to":[1,10],"from":[1,10]},"opacity":{"to":[0,1],"from":[0,1]},"fillOpacity":{"to":[0,1],"from":[0,1]}}]},{"method":"addHomeButton","args":[-80.0825547138503,46.5191712159471,-80.0635306573947,46.5213988429813,true,"Snapped","Zoom to Snapped","<strong> Snapped <\/strong>","bottomright"]},{"method":"addLayersControl","args":["Esri.WorldImagery",["Updated","Snapped"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#00FF00"],"labels":["Snapped"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"Snapped"}]},{"method":"addHomeButton","args":[-80.0825547138503,46.5191712159471,-80.0635306573947,46.5213988429813,true,null,"Zoom to full extent","<strong>Zoom full<\/strong>","bottomleft"]},{"method":"addTiles","args":["https://servicesmatriciels.mern.gouv.qc.ca:443/erdas-iws/ogc/wmts/Inventaire_Ecoforestier/Inventaire_Ecoforestier/default/GoogleMapsCompatibleExt2:epsg:3/{z}/{y}/{x}.jpg",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false}]}],"fitBounds":[46.5191712159471,-80.0825547138503,46.5213988429813,-80.0635306573947,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
<p>Other post-processing functions included in the <code>ALSroads</code> package are:</p>
<ul>
<li><p><code>check_road_differences</code>: Check the amplitude of differences between corrected and uncorrected roads.</p></li>
<li><p><code>st_check_crossings</code>: Check if roads cross at points other than at their ends.</p></li>
<li><p><code>st_check_junctions</code>: Check if road endings are close enough to be considered potential junctions.</p></li>
</ul>

<pre><code>#&gt; &lt;STYLE type=&#39;text/css&#39; scoped&gt;
#&gt; PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};
#&gt; &lt;/STYLE&gt;</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-waterbodies.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-getting-started-with-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
